<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="application/rss+xml; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Dark Bootstrap Admin </title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <!-- Bootstrap CSS-->
  <link rel="stylesheet" href='static/vendor/bootstrap/css/bootstrap.min.css'>
  <!-- Font Awesome CSS-->
  <link rel="stylesheet" href='static/vendor/font-awesome/css/font-awesome.min.css'>
  <!-- Custom Font Icons CSS-->
  <link rel="stylesheet" href='static/css/font.css'>
  <!-- Google fonts - Muli-->
  <link rel="stylesheet" href="static/https://fonts.googleapis.com/css?family=Muli:300,400,700">
  <!-- theme stylesheet-->
  <link rel="stylesheet" href='static/css/style.default.css' id="theme-stylesheet">
  <!-- Custom stylesheet - for your changes-->
  <link rel="stylesheet" href='static/css/custom.css'>
  <!-- Favicon-->
  <link rel="shortcut icon" href='static/img/favicon.ico'>
  <!-- Tweaks for older IEs-->
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->

</head>

<body>
  <header class="header">
    <nav class="navbar navbar-expand-lg">
      <div class="search-panel">
        <div class="search-inner d-flex align-items-center justify-content-center">
          <div class="close-btn">Close <i class="fa fa-close"></i></div>
          <form id="searchForm" action="#">
            <div class="form-group">
              <input type="search" name="search" placeholder="What are you searching for...">
              <button type="submit" class="submit">Search</button>
            </div>
          </form>
        </div>
      </div>
      <div class="container-fluid d-flex align-items-center justify-content-between">
        <div class="navbar-header">
          <!-- Navbar Header--><a href="/" class="navbar-brand">
            <div class="brand-text brand-big visible text-uppercase"><strong class="text-primary">NetFlow</strong><strong>Analysis</strong></div>
            <div class="brand-text brand-sm"><strong class="text-primary">D</strong><strong>A</strong></div></a>
          <!-- Sidebar Toggle Btn-->
          <button class="sidebar-toggle"><i class="fa fa-long-arrow-left"></i></button>
        </div>
        
      </div>
    </nav>
  </header>
  <div class="d-flex align-items-stretch">
    <!-- Sidebar Navigation-->
    <nav id="sidebar">
      <!-- Sidebar Header-->
      <div class="sidebar-header d-flex align-items-center">
        <div class="avatar"><img src="static/img/avatar-6.jpg" alt="..." class="img-fluid rounded-circle"></div>
        <div class="title">
          <h1 class="h5">NetFlow</h1>
          <p>Analysis</p>
        </div>
      </div>
      <!-- Sidebar Navidation Menus--><span class="heading">Main</span>
      <ul class="list-unstyled">
        <li class="active"><a href="/home"> <i class="icon-home"></i>Home </a></li>
        <li><a href="/port"> <i class="icon-grid"></i>Port</a></li>
        <li><a href="#exampledropdownDropdown" aria-expanded="false" data-toggle="collapse"> <i class="icon-windows"></i>Single Path</a>
          <ul id="exampledropdownDropdown" class="collapse list-unstyled ">
            <li><a href="/singlepathsample">Init data</a></li>
            <li><a href="/overall">Overall view</a></li>
            <li><a href="/singlepathdetail">Detail</a></li>
            <li><a href="/iptoipsearch">IP to IP</a></li>
          </ul>
        </li>
        <li><a href="#exampledropdownDropdown0" aria-expanded="false" data-toggle="collapse"> <i class="icon-windows"></i>Multi Path</a>
          <ul id="exampledropdownDropdown0" class="collapse list-unstyled ">
            <li><a href="/multipathscan">Detect scan</a></li>
            <li><a href="/multipathstatistic">Statistic </a></li>
            <li><a href="/multipathtcp">Detail TCP</a></li>
            <li><a href="/multipathdns">DNS service</a></li>
            <li>
              <select id="multichose" name="multichose" class="form-control mb-3 mb-3" value="{{filechose}}" onchange="myfunction()">
                              
                
                <option>Pcap</option>
                
                <option>SiLK</option>
              </select>
              <input type="button" value="{{filechose}}"/>
            </li>
            <script language="javascript">
               function myfunction(){
                  {
                         var data = document.getElementById("multichose").value;
                         const URL = '/multichose';
                          const xhr = new XMLHttpRequest();
                          sender = JSON.stringify(data)
                          //sender =2
                          xhr.open('POST', URL);
                          xhr.send(sender);
                  }
       
              }
            </script>
          </ul>
        </li>                
        <li><a href="#exampledropdownDropdown1" aria-expanded="false" data-toggle="collapse"> <i class="icon-windows"></i>Others</a>
          <ul id="exampledropdownDropdown1" class="collapse list-unstyled ">
            <li><a href="/upload">Upload File</a></li>
            <li><a href="/analyseUpload">Init Uploaded file</a></li>
            <li><a href="/file">Modify</a></li>
            <li><a href="/singlegraphicinit">Graphic</a></li>
          </ul>
        </li>
      </ul>

    </nav>
    <!-- Sidebar Navigation end-->
    <div class="page-content">
      <div class="page-header">
        <div class="container-fluid">
          <h2 class="h5 no-margin-bottom">Dashboard</h2>
        </div>
      </div>
      <section class="no-padding-top">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-12">
              <div class="block">
                <div class="block-body">
                  <form class="form-horizontal" action="/multipathip" method="POST" novalidate>
                    <div class="form-group row">
                      <label class="col-sm-3 form-control-label">Start time</label>
                      <div class="col-sm-9">
                        <input name="startdate" class="form-control mb-3 mb-3" max="{{enddate}}" min="{{startdate}}"
                          type="datetime-local" value="{{_startdate}}" />
                        
                      </div>
                    </div>
                    <div class="form-group row">
                      <label class="col-sm-3 form-control-label">End time</label>
                      <div class="col-sm-9">
                        
                        <input name="enddate" class="form-control mb-3 mb-3" max="{{enddate}}" min="{{startdate}}"
                          type="datetime-local" value="{{_enddate}}" />
                        
                      </div>
                    </div>
                    <div class="form-group row">
                      <label class="col-sm-3 form-control-label">Counts</label>
                      <div class="col-sm-9">
                   
                        <input name="counts" class="form-control mb-3 mb-3" value="{{counts}}" type="number"/>
                      </div>
                    </div>
                    <div class="form-group row">
                      <label class="col-sm-3 form-control-label">Sensor</label>
                      <div class="col-sm-9">
                   
                        <input name="sensor" class="form-control mb-3 mb-3" value="{{num}}" type="text"/>
                      </div>
                    </div>
                    <div class="form-group row">
                      <!--<label class="col-sm-3 form-control-label">Protocol</label>-->
                      <div class="col-sm-9">
                   
                        <!--<input name="protocol" class="form-control mb-3 mb-3" value="{{protocol}}" type="text"/>-->
                        <li><a class="col-sm-3 form-control-label" href="#proto" aria-expanded="false" data-toggle="collapse"> <i
                        ></i>Protocol</a>
                      <ul id="proto" class="collapse list-unstyled ">
                        <li><input type="checkbox" name="allproto" value="allproto" {{allproto}} type="text"/>all</li>
                        {% for x,y in zips %}
                          {% if x!= '' %}
                          <li><input  type="checkbox" name="protocols" value="{{x}}" {{y}} type="text"/>{{x}}</li>
                          {% endif %}
                        {% endfor %}
                      </ul>
                    </li>
                      </div>
                    </div>
                    <div class="form-group row">
                      <label class="col-sm-3 form-control-label">Source-IP</label>
                      <div class="col-sm-9">
                   
                        <input name="sip" class="form-control mb-3 mb-3" value="{{sip}}" type="text"/>
                      </div>
                    </div>
                    <div class="form-group row">
                      <label class="col-sm-3 form-control-label">Dest-IP</label>
                      <div class="col-sm-9">
                   
                        <input name="dip" class="form-control mb-3 mb-3" value="{{dip}}" type="text"/>
                      </div>
                    </div>
                    <div class="form-group row">
                      <div class="col-sm-9 ml-auto">
                        <button type="submit" class="btn btn-primary">Save changes</button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section class="no-padding-bottom">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-12">
              <div class="block">
                <div class="title"><strong>Flow Relationship</strong></div>
                <div class="table-responsive" style="overflow: scroll; height: 400px;">
                  <table class="table table-striped table-sm">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Source Port</th>
                        <th>Destination Port</th>
                        <th>Sensor</th>
                        <th>Protocol</th>
                        <th>Flag</th>
                        <th>Type</th>
                        <th>Start time</th>
                        <th>End time</th>
                        <th>Packets</th>
                        <th>Bytes</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for x in range(lenoftable) %}
   
                        <tr>
                            <td>{{x +1}}</td>
                            {% for num in range(12) %}
                              {% if num==5 %}
                                <td>{{protocols[(table[x])[num]-1]}}</td>
                              {% else %}
                                <td>{{(table[x])[num]}}</td>
                              {% endif %}
                        
                            {% endfor %}
                        
                        </tr>
      
                    {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="block">
                <div class="title"><strong>Flow outgoing of SIP</strong></div>
                <div class="table-responsive" style="overflow: scroll; height: 400px;">
                  <table class="table table-striped table-sm">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Source Port</th>
                        <th>Destination Port</th>
                        <th>Sensor</th>
                        <th>Protocol</th>
                        <th>Flag</th>
                        <th>Type</th>
                        <th>Start time</th>
                        <th>End time</th>
                        <th>Packets</th>
                        <th>Bytes</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for x in range(lenoftable3) %}
   
                        <tr>
                            <td>{{x +1}}</td>
                            {% for num in range(12) %}
                              {% if num==5 %}
                                <td>{{protocols[(table3[x])[num]-1]}}</td>
                              {% else %}
                                <td>{{(table3[x])[num]}}</td>
                              {% endif %}
                        
                            {% endfor %}
                        
                        </tr>
      
                    {% endfor %}
                    </tbody>
                  </table>
                </div>
                <div class="table-responsive" style="overflow: scroll; height: 400px;"> 
                  <table class="table table-striped table-sm">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Type</th>
                        <th>Packets</th>
                        <th>Bytes</th>
                        <th>Records</th>
                        <th>Percent/Total</th>
                        <th>Percent sum</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for x in Datatable1.Table.values.tolist() %}
             
                        <tr>
                            <td>{{Datatable1.Table.values.tolist().index(x) +1}}</td>
                            {% for y in x %}
                              {% if (x.index(y)<6) %}
                                <td>{{y}}</td>
                              {% else %}
                                <td>{{'%.2f
                              ' | format(y|float)}}%</td>
                              {% endif %}
                            {% endfor %}
                        
                        </tr>
            
                    {% endfor %}
                    </tbody>
                  </table>
                  
                </div>
                <div class="row">
                  <div class='col-lg-6'>
                    <div class="title"><strong>Chart</strong></div>
                      <div class="bar-chart block no-margin-bottom">
                        <canvas id="chart1"></canvas>
                      </div>
                    </div>
                  <div class="col-lg-6">
                    <div class="title"><strong>Percentage</strong></div>
                    <div class="pie-chart chart block">
                      
                      <div class="pie-chart chart margin-bottom-sm">
                        <canvas id="PieChart1"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="block">
                <div class="title"><strong>Flow incoming of SIP</strong></div>
                <div class="table-responsive" style="overflow: scroll; height: 400px;">
                  <table class="table table-striped table-sm">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Source Port</th>
                        <th>Destination Port</th>
                        <th>Sensor</th>
                        <th>Protocol</th>
                        <th>Flag</th>
                        <th>Type</th>
                        <th>Start time</th>
                        <th>End time</th>
                        <th>Packets</th>
                        <th>Bytes</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for x in range(lenoftable4) %}
   
                        <tr>
                            <td>{{x +1}}</td>
                            {% for num in range(12) %}
                              {% if num==5 %}
                                <td>{{protocols[(table4[x])[num]-1]}}</td>
                              {% else %}
                                <td>{{(table4[x])[num]}}</td>
                              {% endif %}
                        
                            {% endfor %}
                        
                        </tr>
      
                    {% endfor %}
                    </tbody>
                  </table>
                </div>
                <div class="table-responsive" style="overflow: scroll; height: 400px;"> 
                  <table class="table table-striped table-sm">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Type</th>
                        <th>Packets</th>
                        <th>Bytes</th>
                        <th>Records</th>
                        <th>Percent/Total</th>
                        <th>Percent sum</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for x in Datatable2.Table.values.tolist() %}
             
                        <tr>
                            <td>{{Datatable2.Table.values.tolist().index(x) +1}}</td>
                            {% for y in x %}
                              {% if (x.index(y)<6) %}
                                <td>{{y}}</td>
                              {% else %}
                                <td>{{'%.2f
                              ' | format(y|float)}}%</td>
                              {% endif %}
                            {% endfor %}
                        
                        </tr>
            
                    {% endfor %}
                    </tbody>
                  </table>
                  
                </div>
                <div class="row">
                  <div class='col-lg-6'>
                    <div class="title"><strong>Chart</strong></div>
                      <div class="bar-chart block no-margin-bottom">
                        <canvas id="chart2"></canvas>
                      </div>
                    </div>
                  <div class="col-lg-6">
                    <div class="title"><strong>Percentage</strong></div>
                    <div class="pie-chart chart block">
                      
                      <div class="pie-chart chart margin-bottom-sm">
                        <canvas id="PieChart2"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </div>
      </section>
      <footer class="footer">
        <div class="footer__block block no-margin-bottom">
          <div class="container-fluid text-center">
            <!-- Please do not remove the backlink to us unless you support us at https://bootstrapious.com/donate. It is part of the license conditions. Thank you for understanding :)-->
             <p class="no-margin-bottom">2018 &copy; Your company. Download From <a target="_blank" href="https://templateshub.net">Templates Hub</a>.</p>
          </div>
        </div>
      </footer>
    </div>
  </div>
  <!-- JavaScript files-->
  <script src='static/vendor/jquery/jquery.min.js'></script>
  <script src='static/vendor/popper.js/umd/popper.min.js'> </script>
  <script src='static/vendor/bootstrap/js/bootstrap.min.js'></script>
  <script src='static/vendor/jquery.cookie/jquery.cookie.js'> </script>
  <script src='static/vendor/chart.js/Chart.min.js'></script>
  <script src='static/vendor/jquery-validation/jquery.validate.min.js'></script>
  <script src='static/js/charts-home.js'></script>
  <script src='static/js/front.js'></script>
  {% block code %}
  <script>
  {{chart1|safe}}
  {{PieChart1|safe}}
  {{chart2|safe}}
  {{PieChart2|safe}}
  </script>
  {% endblock code %}
</body>

</html>